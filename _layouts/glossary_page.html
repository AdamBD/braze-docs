---
layout: default
hide_toc: true
hide_bottom_nav: true
hide_breadcrumb: true
---



{%- comment -%} Assigned variables first by page, then by layout {%- endcomment -%}
{%- assign hide_nav = page.hide_nav -%}


{%- assign hide_bottom_nav = page.hide_bottom_nav -%}
{%- assign hide_breadcrumb = page.hide_breadcrumb -%}
{%- assign hide_feedback = page.hide_feedback -%}
{%- unless hide_nav -%}
{%- assign hide_nav = layout.hide_nav -%}
{%- endunless -%}

{%- unless hide_bottom_nav -%}
{%- assign hide_bottom_nav = layout.hide_bottom_nav -%}
{%- endunless -%}
{%- unless hide_breadcrumb -%}
{%- assign hide_breadcrumb = layout.hide_breadcrumb -%}
{%- endunless -%}
{%- unless hide_feedback -%}
{%- assign hide_feedback = layout.hide_feedback -%}
{%- endunless -%}



{% unless hide_nav %}
<!-- button id="sidebar_toggle" class="btn btn-info d-print-none" data-toggle="collapse" aria-expanded="true" href="#nav_bar" >
   <i class="fas"></i>
</button -->

<script type="text/javascript">

{%- comment -%} Tag list allows for name and icon or image.{%- endcomment -%}

{%- assign glossary_tags = '' -%}
{%- for category in page.glossary_tags -%}
  {%- if glossary_tags != '' -%}
    {%- assign glossary_tags = glossary_tags | append: ','  -%}
  {%- endif -%}

  {%- capture glossary_tags -%}
  {{ glossary_tags }}
  "{{ category['name'] | downcase | replace: '"', '\\"' }}": ["{{ category['name'] | replace: '"', '\\"' }}","{{ category['icon'] | replace: '"', '\\"' }}","{{ category['image'] | replace: '"', '\\"' }}"]
  {%- endcapture -%}
{% endfor %}

var glossary_tags = {
  {{ glossary_tags }}
};

{%- comment -%} Data order: 0 name, 1 description,2 metric,3 calculation,4 tags {%- endcomment -%}
{%- assign glossary_list = '' -%}
{%- for glossary in page.glossaries -%}
  {%- if glossary_list != '' -%}
    {%- assign glossary_list = glossary_list | append: ','  -%}
  {%- endif -%}
  {%- capture glossary_list -%}
  {{ glossary_list }}
  "{{ glossary['name'] | downcase | replace: '"', '\\"' }}": ["{{ glossary['name'] | replace: '"', '\\"' }}","{{ glossary['description'] | replace: '"', '\\"' }}","{{ glossary['metric'] | replace: '"', '\\"' }}","{{ glossary['calculation'] | replace: '"', '\\"' }}",
  {%- endcapture -%}
  {%- assign glossary_tag = '' -%}
  {%- assign glossary_list = glossary_list | append: '['  -%}
  {%- for tag in glossary.tags -%}
    {%- if glossary_tag != '' -%}
      {%- assign glossary_tag = glossary_tag | append: ','  -%}
    {%- endif -%}
    {%- assign gtag = tag | replace: '"', '\\"' -%}
    {%- assign glossary_tag = glossary_tag | append: '"' | append: gtag  | append: '"' -%}
  {%- endfor -%}
  {%- assign glossary_list = glossary_list | append: glossary_tag | append: ']]'  -%}
{% endfor %}

var glossaries_list = {
  {{ glossary_list }}
};

var glossary_map = {
  'name': 0,
  'description': 1,
  'metric': 2,
  'calculation': 3,
  'tags': 4,
  'glossary_tags': 4
}
$(document).ready(function() {
  function string_to_slug (str) {
    str = str.replace(/^\s+|\s+$/g, ''); // trim
    str = str.toLowerCase();

    // remove accents, swap ñ for n, etc
    var from = "àáäâèéëêìíïîòóöôùúüûñç·/_,:;";
    var to   = "aaaaeeeeiiiioooouuuunc------";
    for (var i=0, l=from.length ; i<l ; i++) {
        str = str.replace(new RegExp(from.charAt(i), 'g'), to.charAt(i));
    }

    str = str.replace(/[^a-z0-9 -]/g, '-') // remove invalid chars
        .replace(/\s+/g, '-') // collapse whitespace and replace by -
        .replace(/-+/g, '-'); // collapse dashes

    return str;
  }
  var glossary_div = $('#glossary_list');

  // // category, channel
  var filter_map = ['glossary_tags'];
  var glossary_selects = [glossary_tags];
  var filter_select = ['glossary_tags'];

  var alltags = []
  $.each(glossary_tags,function(k,v){
    alltags.push(v[0]);
  });

  function searchterms(searchterm, items) {
    var found = false;
    if (Array.isArray(items)) {
      for (var i = 0; i < items.length; i++ ) {
        if (items[i].toLowerCase() == searchterm.toLowerCase()) {
          found = true
        }
      }
    }
    else {
      if (items.toLowerCase().indexOf(searchterm.trim().toLowerCase()) > -1) {
        found = true
      }
    }
    return found;
  }

  function generate_card(cur_glossary){
    var card_id = string_to_slug(cur_glossary[glossary_map['name']]);
    var card_title = $('<div>').addClass('title').html(cur_glossary[glossary_map['name']]);
    var tags = cur_glossary[glossary_map['tags']];

    if (searchterms('all', tags)) {
      tags = alltags;
    }
    var card_tag = $('<div>').addClass('tags');
    for (var i = 0; i < tags.length; i++ ) {
      var tag_item = $('<div>').addClass('tag');
      if (i > 0) {
        tag_item.html(', ' + tags[i] + ' ');
      }
      else {
        tag_item.html(tags[i] + ' ');
      }
      var tag_opts = glossary_tags[tags[i].toLowerCase()]
      if (tag_opts ){
        if (tag_opts[2]) {
          tag_item.append($('<img>').addClass('tag_img').attr('src',tag_opts[2]));
        }
        else {
          tag_item.append($('<i>').addClass(tag_opts[1]));
        }
      }
      card_tag.append(tag_item)
    }
    var card_desc = $('<div>').addClass('desc').html(cur_glossary[glossary_map['description']]);

    var card_metric = '';
    if  (cur_glossary[glossary_map['metric']]) {
      card_metric = $('<div>').addClass('metric').html(cur_glossary[glossary_map['metric']]);
    }
    var card_calc = '';
    if  (cur_glossary[glossary_map['calculation']]) {
      card_calc = $('<div>').addClass('caclulation').html(cur_glossary[glossary_map['calculation']]);
    }

    var card_div = $('<div>').addClass('content').append(card_title).append(card_tag).append(card_metric).append(card_calc).append(card_desc);

    var append_html = $('<span>').attr('id','card_' + card_id).addClass('card').append(card_div);
    return append_html;
  }

  function set_filters () {
    for (var j = 0; j < filter_map.length; j++) {
      var par_sel = $('#' + filter_select[j]);
      var par_sorted = [];

      $.each(glossary_selects[j],function(k,v){
        if (k != 'all') {
          par_sorted.push(k);
        }
      });
      par_sorted.sort();
      for (var i = 0; i < par_sorted.length;i++ ){
        par_sel.append($("<option>").attr("value",par_sorted[i]).text(glossary_selects[j][par_sorted[i]][glossary_map['name']]));
      }

    }
  };

  function generate_glossarys(glossary_hash,initialize) {
    var result_cnt = 0;
    $('#results_msg').hide();

    for (var i = 0; i < glossary_hash['sorted'].length;i++){
      var cur_glossary = glossary_hash['data'][glossary_hash['sorted'][i]];
      var cur_filter_text = glossary_hash['search'][glossary_hash['sorted'][i]];
       if (initialize) {
         glossary_div.append(generate_card(cur_glossary));
         result_cnt++;
       }
       else {
         var toappend = true;
         var filtered = true;
         for (var k = 0 ; k < filter_select.length; k++ ) {
           var selected_val = $('#' + filter_select[k] +  " option:selected").val();
           if (selected_val) {
             toappend = false;
             if (!searchterms(selected_val, cur_glossary[glossary_map[filter_map[k]]]))  {
               filtered = false;
             }
           }
         }
         var search_str = $('#glossary_search').val().toLowerCase();
         if (search_str.length ) {
           toappend = false;
           if (!searchterms(search_str, cur_filter_text)) {
             filtered = false;
           }
         }

         if (filtered) {
           toappend = true;
         }
         if (toappend ) {
           $('#card_' + string_to_slug(cur_glossary[glossary_map['name']])).show();
           result_cnt++;
         }
         else {
           $('#card_' + string_to_slug(cur_glossary[glossary_map['name']])).hide();
         }
       }
    }
    if (!result_cnt) {
      $('#results_msg').html('<p>No glossarys matching these filters</p>');
      $('#results_msg').show();
    }

  };
  var glossary_hash = {'data':{},'search': {}, 'sorted': []};

  $.each(glossaries_list,function(k,v) {
    glossary_hash['data'][k] = v;
    glossary_hash['search'][k] = v.join(' ').toLowerCase();
    if (searchterms('all', v[glossary_map['tags']]) ) {
      glossary_hash['search'][k] += alltags.join(' ');
    }
    glossary_hash['sorted'].push(k);
  })
  glossary_hash['sorted'].sort();
  set_filters();

  generate_glossarys(glossary_hash,true);

  for (var i = 0 ; i < filter_select.length; i++ ) {
    $('#' + filter_select[i]).on('change',function(e){
      generate_glossarys(glossary_hash,false);
    });
  }

  $('#glossary_search').on('keyup',function(e){
    generate_glossarys(glossary_hash,false);
  });

});
</script>

<div class="col-sm-12 col-md-3 col-lg-3 col-xl-2 d-print-none collapse d-md-block" id="nav_bar"  >
  <div id="nav_col" class="  ">
  {% include left_nav_menu.html  %}
  </div>
</div>
{% endunless %}

<div class="col d-print-block " id="main_content" >

    <div id="glossary-main">


    <h1> {{ page.glossary_top_header }} </h1>
    <p class="glossary_text">  {{ page.glossary_top_text }} </p>

    <div id="glossary_filter">
      <div class="glossary_filter_div">
        <input id="glossary_search" type="search" placeholder="Search"></div>
      <div class="glossary_filter_div"><select id="glossary_tags" class="select">
        <option value="">All {{ page.glossary_tag_name }}</option>
      </select>

      </div>

    </div>

    <div id="glossary_list" class="flex mx-auto">

    </div>
    <div id="results_msg"></div>


  </div>
    {%- unless hide_bottom_nav -%}
    <div id="bottom_nav" >
      {%- unless hide_feedback -%}
      {% include feedback.html  %}
      {%- endunless -%}
      <!-- div class="gradient-line" ></div -->
    </div>

    {%- endunless -%}

    {% include footer.html class="footer_glossary" %}
</div>
